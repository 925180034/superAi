<!DOCTYPE html>
<html>
<head>
    <title>API Debug</title>
</head>
<body>
    <h1>API配置调试</h1>
    <div id="debug-info"></div>
    <script type="module">
        import API_BASE_URL, { API_ENDPOINTS } from './src/config/api.js';
        
        const debugInfo = document.getElementById('debug-info');
        debugInfo.innerHTML = `
            <h2>当前API配置:</h2>
            <p><strong>API_BASE_URL:</strong> ${API_BASE_URL}</p>
            <p><strong>Health Chat 端点:</strong> ${API_ENDPOINTS.healthChat}</p>
            <p><strong>完整健康聊天URL:</strong> ${API_BASE_URL}${API_ENDPOINTS.healthChat}</p>
            <p><strong>实际请求URL示例:</strong> ${API_BASE_URL}${API_ENDPOINTS.healthChat}?message=测试&chatId=debug123</p>
            <p><strong>环境变量 MODE:</strong> ${import.meta.env.MODE}</p>
            <p><strong>环境变量 VUE_APP_API_BASE_URL:</strong> ${import.meta.env.VUE_APP_API_BASE_URL || '未设置'}</p>
            <hr>
            <h3>测试健康聊天API:</h3>
            <button onclick="testHealthAPI()">测试API连接</button>
            <div id="test-result"></div>
        `;
        
        window.testHealthAPI = async () => {
            const resultDiv = document.getElementById('test-result');
            resultDiv.innerHTML = '<p>测试中...</p>';
            
            try {
                const url = `${API_BASE_URL}${API_ENDPOINTS.healthChat}?message=测试&chatId=debug123`;
                console.log('测试URL:', url);
                
                const response = await fetch(url, {
                    method: 'GET',
                    headers: {
                        'Accept': 'text/event-stream',
                        'Cache-Control': 'no-cache'
                    }
                });
                
                resultDiv.innerHTML = `
                    <p><strong>状态码:</strong> ${response.status}</p>
                    <p><strong>状态文本:</strong> ${response.statusText}</p>
                    <p><strong>URL:</strong> ${url}</p>
                `;
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
            } catch (error) {
                resultDiv.innerHTML = `<p style="color: red;"><strong>错误:</strong> ${error.message}</p>`;
                console.error('API测试失败:', error);
            }
        };
    </script>
</body>
</html>